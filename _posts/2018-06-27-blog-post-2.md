---
title: "The Fundemental Confidence Fallacy"
author: "Ben Buzzee"
permalink: /posts/2018/06/blog-post-2/
date: "June 26, 2018"
fontsize: 14pt
output: html_document
---

 "Claims that confidence intervals yield an
index of precision, that the values within them are plausible,
and that the confidence coefficient can be read as
a measure of certainty that the interval contains the true
value, are all fallacies and unjustified by confidence interval
theory." - The Fallacy of Placing Confidence in Confidence Intervals

Modern introductory statistics classes tend to focus exclusively on frequentist-style confidence intervals and hypothesis tests. As the field of statistics matures, many of the shortcomings of hypothesis tests have come to light (see papers 1 and 2), leaving the confidence interval as the preferred research tool new and veteran practitioners of statistics alike. Although taught in virtually every introductory statistics course in the United States, confidence intervals are widely misused and misinterpreted, even by professional scientists. This post attempts to clarify exactly what a confidence interval is and how to correctly interpret them.



# The Problem

The need for interval estimation arises when a researcher is interested in knowing the value of an important quantity that describes an entire population (a parameter), and, for one reason or another, the entire population cannot be measured. Thus the researcher must rely on a sample to estimate the value of the parameter. The problem, then, is that different samples typically produce different estimates of the parameter of interest. The solution is to create an interval that somehow takes into account our uncertainty in a quantifiable manner.

One solution, and the one taught in virtually every introductory statistics class in the United States, is the frequentist-style confidence interval. Confidence intervals were originally developed by Jerzy Neyman in his 1937 paper "Outline of a Theory of Statistical Estimation Based on the Classical Theory of Probability." This is the same Jerzy Neyman that worked with Egon Pearson over the course of the previous several years to develop the theory behind frequentist style hypothesis testing. https://ww2.amstat.org/about/statisticiansinhistory/index.cfm?fuseaction=biosinfo&BioID=11

When it comes to confidence intervals, Neyman recommends a three step procedure: 1. collect a sample, 2. create the interval (using methodology laid out in the paper) and 3. claim the value of the parameter is in the interval.

He goes on to say (and try to make sense of this):

> The justification of this recommendation lies in the fact that the three steps
described are equivalent to a random experiment which may result either in a correct
or in an erroneous statement concerning the value of [the parameter], the probability of a correct
statement being equal to .99. Thus the statistician following the above recommendation
is in a position comparable with that of a game of chance with the
probability of winning being equal to .99.

And so, according to Neyman, we do our study, create our interval, and claim the parameter is contained in the interval. The probability we "win," or that our claim is correct, is equal to our confidence level. And so the problem of coherently quantitifying the uncertainty involved with estimating a parameter is solved... right? 

Unfortunately, Neyman is a master of subtle convolution that leads to technically valid statements but a terribly misled reader. The first 10 times you read the above passage, unless you are a well trained statistician, you are (probably) not correctly interpreting the subtleties employed by Neyman.

The natural interpretation of the above passage--that we can create a confidence interval, make the claim that our interval contains the parameter, and be correct with .99 probability is __NOT__ what the above passage says. We will get to the correct interpretation a bit later.

The issues with the above passage are a microcosm of all the problems with confidence intervals. They are difficult to (correctly) understand, it is natural and easy to incorrectly interpret them, and they are perfectly valid mathematically. Further, it is often inconsequential to misinterpet them in the way we are naturally inclined to do. This has led to extremely widespread misuse and misinterpretation even by professional scientists.


# Frequentist Probabilities

Confidence intervals are inextricably tied to the frequentist definition of probability. Frequentist style statistics defines the probability of an event as the relative frequency of that event as the number of trials (or times the event _could_ have occured) tends towards infinity. To make a probabilistic claim, it must be set up in the context of theoretical long-run frequencies. This is the definition typically used in an introductory statistics class--whether students (or even the teacher!) know it.

For example, suppose we are interested in fair coin flips. The probability of a heads is equal to the limit of the number of heads flipped divided by the total number of flips, as the number of flips goes to infinity. For a genuinely fair coin, this would be 1/2. Notice this is a theoretical probability--and no actual coin flipping was required! 

Now, say, we actually flipped a coin once. What is the probability the coin that now lays stationary on the ground is heads? Well, the coin is laying fixed on the ground -- the only "trial" we could conceivably study is the trial of us repeating our claim that it is heads an infinite number of times. If we were to do that, we'd either be right 100% of the time or wrong 100% of the time--with nothing in between. Thus the probability of heads, under the frequentist framework, is either 0 or 1.

The key takeaway here is that frequentist _probabilities are attached to a process_. The fair _coin flipping process_ results in a heads with .5 probability. The _process of repeating a claim_ about a coin fixed on the ground has a probability of being corrrect of either 0 or 1.


# Gambling and Frequentists Probabilities

Suppose money is on the line (Note: Money can be replaced by any cost/reward tied to decision making). Does the fact that we can't make probabilistic claims about fixed outcomes mean frequentists probabilities are useless? Lets say a process results in outcome A 99% of the time, and outcome B 1% of the time. Suppose a single trial is performed behind a curtain and you stand to make 1,000,000 dollars if you correctly guess which outcome occurred, and to lose 10,000 dollars if you are wrong. Would you partake?


We know if we attach "guess A" to the trial-behind-a-curtain __process__ we would have a 99% chance of winning 1,000,000 dollars and a 1% chance of losing 10,000 dollars in the long run, and have an expected return of 989,900. Thus our frequentist probabilities are extremely useful if we find ourselves faced with many of such decisions, as we are able to quantify our gains/losse, and be relatively certain about them over the long term (How many trials we need to attain a certain level of confidence is determined by the convergence in coverage probabilities, a topic to be tackled another day). Here, we've attached "take action A" to the random process, and used our understanding of the process to derive costs/benefits.

But what about if we have one and only guess? Is the probability of the procedure relevant?



# The Confidence Interval

Now that we have an understanding of probability, we can define a confidence interval.

### Definition(s)

Definition (Confidence Interval): 
> An X% confidence interval for a parameter theta is an interval (L,U) generated
by a procedure that in repeated sampling has an X% probability
of containing the true value of theta (Neyman, 1937).

This definition leads to some natural questions:

* Is the probability associated with __a procedure under repeated sampling__ scientifically relevant? 

Just as it is relevant to a betting scenario, it is relevant to scientists making non-monetary "bets."

* What is meant by repeated sampling? Two samples? Infinite samples? What about the all-important one sample we have in front of us?

As long as the samples are random, future intervals will all have the same probability of bracketing the parameter. So repeated sampling is just a mechanism used to define probability. A certain number of trials will be needed to ensure our coverage probabilities ensure to our confidence level -- this is an important point.

* Do we have any level of certainty the parameter is in the interval? 

We don't have certainty a parameter is in a interval, just as we cannot make probabilities claims about a coin that has already been tossed, or a die that has already been rolled. But we can attach actions to trials, and quantify long-run costs. But what if each "trial" has a different cost?





# Back to Quote

Neyman is talking about the whole process - not the interval. The whole process is akin to a game of chance, with frequentist probability of .99. Is this acceptable?: the probability the interval brackts the parameter .99?


### Interpretation

A useful analogy: You have a tennis ball and a large plastic bowl. The ball represents the parameter(s) of interest and the bowl represents the confidence region. When we create a 95% confidence interval, the natural (and incorrect) interpretation is to assume that when the ball is tossed, there is a 95% chance it lands in the bowl. The correct interpretation requires the ball be fixed on the ground, and if we toss the bowl repeatedly, the percentage of time the bowl lands and covers the ball tends towards 95% as the bowl is repeatedly tossed.

If we toss the bowl once (create one frequentist confidence interval), the bowl either captured the ball or did not. We cannot make any probabilistic claims about the ball being in the bowl. We can state that __ if we tossed the bowl many times, __ the frequency with which the bowl lands and covers the ball will tend toward .95. The .95 probability only has meaning in the context of many bowl tosses.

Now suppose we are in the position of making a major decision based on a single confidence interval. Is the fact that a 95% long-run coverage procedure was used to create the interval relevant to our single-interval scenario? Can we just assume the probability the parameter is in the interval is 95%?


What we would really like to know is:

What is the probability the bowl covers the ball if we were only to toss the bowl once?



### Conclusion

If, as part of your research, you are making the request: 

> "Give me an interval that will bracket the true value of the parameter in 100p% of the instances of an experiment that is repeated a large number of times."

Then a frequentist style confidence interval is the appropriate solution to that request. Arguably, however, that is not in-line with what many (most) researchers are seeking when it comes to estimating parameters.


# The Bayesian Alternative: Credible Intervals

### The Bayesian way of Thinking

* Based on properties of posterior distributions.
* Only became popular when computing and MCMC allowed posteriors to be adequately described.

### Definition

* Probability as a degree of belief

>"The credible interval is an answer to the request: "Give me an interval that brackets the true value with probability p given the particular sample I've actually observed."


### Other Properties
Other than provide an interval with the aforementioned property, what else do CIs tell us? Do they:
* provide a sense of variability of the estimate?
* provide a range of plausible values?



### Problems with confidence intervals
 * Definition lends itself to misinterpretation & confusion
 * Answering the wrong question?







https://www.quora.com/How-can-I-deeply-understand-statistics

Quora 1:
> Here are some questions to develop deeper understanding of statistics (I may keep adding to this if I think of more):
 * Under what circumstances, if any, does it make sense to follow the convention of fixing probability of Type I error and maximizing power subject to that constraint?
 * Under what circumstances, if any, is a confidence interval a "reasonable range of values" for an unknown parameter?
 * Why was the word "confidence" introduced into statistical practice? What does it convey that "probability" does not?
 * Is it better to draw weak conclusions with weak assumptions (non-parametric methods) or strong conclusions with strong assumptions (Bayesian methods)?
  * Why are asymptotic results useful, given that real data is always finite?
  * What are the pros and cons of using an arbitrary p-value cutoff like 0.05 to decide whether research should be published?
  * If I analyze data from a clinical trial using a non-parametric test based on randomization of treatment assignments only, can I draw any conclusions about the effectiveness of the treatment in the full population? On what basis?
  * Under what circumstances should I do a one-tailed test versus a two-tailed test?
  * What, if anything, is so great about unbiasedness? -Michael Hochster



https://stats.stackexchange.com/questions/26450/why-does-a-95-confidence-interval-ci-not-imply-a-95-chance-of-containing-the/26457#26457
https://stats.stackexchange.com/questions/11609/clarification-on-interpreting-confidence-intervals

Quora 2:
> I think the fundamental problem is that frequentist statistics can only assign a probability to something that can have a long run frequency. Whether the true value of a parameter lies in a particular interval or not doesn't have a long run frequency, becuase we can only perform the experiment once, so you can't assign a frequentist probability to it. The problem arises from the definition of a probability. If you change the definition of a probability to a Bayesian one, then the problem instantly dissapears as you are no longer tied to discussion of long run frequencies.

> See my (rather tounge in cheek) answer to a related question here:

> "A Frequentist is someone that believes probabilies represent long run frequencies with which events ocurr; if needs be, he will invent a fictitious population from which your particular situation could be considered a random sample so that he can meaningfully talk about long run frequencies. If you ask him a question about a particular situation, he will not give a direct answer, but instead make a statement about this (possibly imaginary) population."

> In the case of a confidence interval, the question we normally would like to ask (unless we have a problem in quality control for example) is "given this sample of data, return the smallest interval that contains the true value of the parameter with probability X". However a frequentist can't do this as the experiment is only performed once and so there are no long run frequencies that can be used to assign a probability. So instead the frequentist has to invent a population of experiments (that you didn't perform) from which the experiment you did perform can be considered a random sample. The frequentist then gives you an indirect answer about that fictitious population of experiments, rather than a direct answer to the question you really wanted to ask about a particular experiment.
> Essentially it is a problem of language, the frequentist definition of a popuation simply doesn't allow discussion of the probability of the true value of a parameter lying in a particular interval. That doesn't mean frequentist statistics are bad, or not useful, but it is important to know the limitations.


Stat stack exchange:

>I think the premise of this question is flawed because it denies the distinction between the uncertain and the known.

> Describing a coin flip provides a good analogy. Before the coin is flipped, the outcome is uncertain; afterwards, it is no longer "hypothetical." Confusing this fait accompli with the actual situation we wish to understand (the behavior of the coin, or decisions that are to be made as a result of its outcome) essentially denies a role for probability in understanding the world.

> This contrast is thrown in sharp relief within an experimental or regulatory arena. In such cases the scientist or the regulator know they will be faced with situations whose outcomes, at any time beforehand, are unknown, yet they must make important determinations such as how to design the experiment or establish the criteria to use in determining compliance with regulations (for drug testing, workplace safety, environmental standards, and so on). These people and the institutions for which they work need methods and knowledge of the probabilistic characteristics of those methods in order to develop optimal and defensible strategies, such as good experimental designs and fair decision procedures that err as little as possible.

> Confidence intervals, despite their classically poor justification, fit into this decision-theoretic framework. When a method of constructing a random interval has a combination of good properties, such as assuring a minimal expected coverage of the interval and minimizing the expected length of the interval--both of them a priori properties, not a posteriori ones--then over a long career of using that method we can minimize the costs associated with the actions that are indicated by that method.


# SOURCES

1. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5540883/
2. https://www.jstor.org/stable/3802789?seq=1#page_scan_tab_contents
3. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4742490/
